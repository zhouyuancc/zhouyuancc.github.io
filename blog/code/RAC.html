<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1404.34">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px 'PingFang SC'}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px 'PingFang SC'; min-height: 25.0px}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px 'Helvetica Neue'; color: #737373}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Menlo; min-height: 21.0px}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Menlo; color: #1d9421}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px 'PingFang SC'; color: #1d9421}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Menlo}
    p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px 'PingFang SC'; background-color: #e0edd4; min-height: 25.0px}
    p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Menlo; color: #1d9421; background-color: #fff995}
    p.p11 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Menlo; color: #c91b13}
    p.p12 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Menlo; color: #3c828c}
    p.p13 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Menlo; color: #c32275}
    p.p14 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Menlo; color: #3d1d81}
    p.p15 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Menlo; color: #294c50; background-color: #fff995}
    p.p16 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Menlo; color: #294c50}
    p.p17 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Menlo; background-color: #fff995}
    span.s1 {font-kerning: none}
    span.s2 {font: 18.0px 'PingFang SC'; font-kerning: none}
    span.s3 {font-variant-ligatures: no-common-ligatures}
    span.s4 {font-variant-ligatures: no-common-ligatures; color: #000000}
    span.s5 {font: 18.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures}
    span.s6 {font: 18.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000}
    span.s7 {font: 18.0px Menlo; font-variant-ligatures: no-common-ligatures}
    span.s8 {font-variant-ligatures: no-common-ligatures; color: #822e0e}
    span.s9 {font-variant-ligatures: no-common-ligatures; color: #c32275}
    span.s10 {font-variant-ligatures: no-common-ligatures; color: #6122ae}
    span.s11 {font-variant-ligatures: no-common-ligatures; color: #3c828c}
    span.s12 {font-variant-ligatures: no-common-ligatures; color: #294c50}
    span.s13 {font-variant-ligatures: no-common-ligatures; color: #1d9421}
    span.s14 {font: 18.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #1d9421}
    span.s15 {font-variant-ligatures: no-common-ligatures; color: #3d1d81}
    span.s16 {font-variant-ligatures: no-common-ligatures; color: #c91b13}
    span.s17 {font: 18.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #c91b13}
    span.s18 {font: 18.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; background-color: #fff995}
    span.s19 {font-variant-ligatures: no-common-ligatures; background-color: #fff995}
    span.s20 {font-variant-ligatures: no-common-ligatures; color: #0435ff}
    span.s21 {font-variant-ligatures: no-common-ligatures; color: #539aa4}
    span.s22 {font-variant-ligatures: no-common-ligatures; color: #703daa}
    span.s23 {font-variant-ligatures: no-common-ligatures; color: #539aa4; background-color: #fff995}
    span.s24 {font-variant-ligatures: no-common-ligatures; color: #000000; background-color: #fff995}
    span.s25 {font-variant-ligatures: no-common-ligatures; color: #78492a}
    span.Apple-tab-span {white-space:pre}
  </style>
</head>
<body>
<p class="p1">block<span class="Apple-converted-space"> </span></p>
<p class="p2">下一级的代码 在上一层调用</p>
<p class="p2">在下一级中定义block，在上一级调用block</p>
<p class="p3"><br></p>
<p class="p2">链式编程思想：是将多个操作（多行代码）通过点号(.)链接在一起成为一句代码,使代码可读性好。a(1).b(2).c(3)</p>
<p class="p3"><br></p>
<p class="p2">响应式编程思想`：不需要考虑调用顺序，只需要知道考虑结果，类似于蝴蝶效应，产生一个事件，会影响很多东西，这些事件像流一样的传播出去，然后影响结果，借用面向对象的一句话，万物皆是流。</p>
<p class="p3"><br></p>
<p class="p4"><span class="s1">ReactiveCocoa</span><span class="s2">被描述为函数响应式编程（</span><span class="s1">FRP</span><span class="s2">）框架</span></p>
<p class="p3"><br></p>
<p class="p2">int a = 0;</p>
<p class="p2">int b = 0;</p>
<p class="p2">int c = a + b;</p>
<p class="p3"><br></p>
<p class="p2">修改a = 3;<span class="Apple-converted-space">  </span>b = 4;</p>
<p class="p2">则c也修改</p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// </span><span class="s5">只要</span><span class="s3">p</span><span class="s5">的</span><span class="s3">age</span><span class="s5">属性一改变</span><span class="s3">,</span><span class="s5">就会调用观察者的</span><span class="s3">observeValueForKeyPath</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// KVO</span><span class="s5">底层实现</span><span class="s3">:</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// 1.</span><span class="s5">动态创建</span><span class="s3">NSKVONotifying_Person,NSKVONotifying_Person</span><span class="s5">是</span><span class="s3">Person</span><span class="s5">子类</span><span class="s3">,</span><span class="s5">做</span><span class="s3">KVO</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// 2.</span><span class="s5">修改当前对象的</span><span class="s3">isa</span><span class="s5">指针</span><span class="s3">-&gt;NSKVONotifying_Person</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// 3.</span><span class="s5">只要调用对象的</span><span class="s3">set,</span><span class="s5">就会调用</span><span class="s3">NSKVONotifying_Person</span><span class="s5">的</span><span class="s3">set</span><span class="s5">方法</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// 4.</span><span class="s5">重写</span><span class="s3">NSKVONotifying_Person</span><span class="s5">的</span><span class="s3">set</span><span class="s5">方法</span><span class="s3">,1.[super set:] 2.</span><span class="s5">通知观察者</span><span class="s3">,</span><span class="s5">告诉你属性改变</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s7">// </span><span class="s3">就是去判断有没有调用一个对象的</span><span class="s7">set</span><span class="s3">方法</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p2"><span class="s3">函数式编程思想</span><span class="s7">`</span><span class="s3">：是把操作尽量写成一系列嵌套的函数或者方法调用。</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p2"><span class="s7">*<span class="Apple-tab-span">	</span>`</span><span class="s3">函数式编程特点</span><span class="s7">`</span><span class="s3">：每个方法必须有返回值（本身对象）</span><span class="s7">,</span><span class="s3">把函数或者</span><span class="s7">Block</span><span class="s3">当做参数</span><span class="s7">,block</span><span class="s3">参数（需要操作的值）</span><span class="s7">block</span><span class="s3">返回值（操作结果）</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p8"><span class="s3">*<span class="Apple-tab-span">	</span>`</span><span class="s5">代表</span><span class="s3">`</span><span class="s5">：</span><span class="s3">ReactiveCocoa</span><span class="s5">。</span></p>
<p class="p9"><span class="s3"></span><br></p>
<p class="p10"><span class="s3">//<span class="Apple-converted-space">  </span>ReactiveCocoa</span><span class="s5">开发中常见用法</span><span class="s3"><span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s3">//<span class="Apple-converted-space">  </span>ViewController.m</span></p>
<p class="p6"><span class="s3">//<span class="Apple-converted-space">  </span>ReactiveCocoa</span></p>
<p class="p6"><span class="s3">//</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p11"><span class="s8">#import </span><span class="s3">"ViewController.h"</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p11"><span class="s8">#import </span><span class="s3">"ReactiveCocoa.h"</span></p>
<p class="p11"><span class="s8">#import </span><span class="s3">"RedView.h"</span></p>
<p class="p12"><span class="s9">@interface</span><span class="s4"> </span><span class="s3">ViewController</span><span class="s4"> ()</span></p>
<p class="p13"><span class="s3">@property</span><span class="s4"> (</span><span class="s3">weak</span><span class="s4">, </span><span class="s3">nonatomic</span><span class="s4">) </span><span class="s3">IBOutlet</span><span class="s4"> </span><span class="s10">UIButton</span><span class="s4"> *btn;</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p13"><span class="s3">@property</span><span class="s4"> (</span><span class="s3">nonatomic</span><span class="s4">, </span><span class="s3">assign</span><span class="s4">) </span><span class="s3">int</span><span class="s4"> age;</span></p>
<p class="p13"><span class="s3">@property</span><span class="s4"> (</span><span class="s3">weak</span><span class="s4">, </span><span class="s3">nonatomic</span><span class="s4">) </span><span class="s3">IBOutlet</span><span class="s4"> </span><span class="s11">RedView</span><span class="s4"> *redView;</span></p>
<p class="p13"><span class="s3">@property</span><span class="s4"> (</span><span class="s3">weak</span><span class="s4">, </span><span class="s3">nonatomic</span><span class="s4">) </span><span class="s3">IBOutlet</span><span class="s4"> </span><span class="s10">UITextField</span><span class="s4"> *textField;</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p13"><span class="s3">@end</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p8"><span class="s9">@implementation</span><span class="s3"> ViewController</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p8"><span class="s3">- (</span><span class="s9">void</span><span class="s3">)viewDidLoad {</span></p>
<p class="p14"><span class="s4"><span class="Apple-converted-space">    </span>[</span><span class="s9">super</span><span class="s4"> </span><span class="s3">viewDidLoad</span><span class="s4">];</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// Do any additional setup after loading the view, typically from a nib.</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">   </span></span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s7">// </span><span class="s3">创建热门商品的信号</span></p>
<p class="p12"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">RACSignal</span><span class="s4"> *signalA = [</span><span class="s3">RACSignal</span><span class="s4"> </span><span class="s12">createSignal</span><span class="s4">:^</span><span class="s3">RACDisposable</span><span class="s4"> *(</span><span class="s9">id</span><span class="s4">&lt;</span><span class="s3">RACSubscriber</span><span class="s4">&gt; subscriber) {</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">       </span></span><span class="s13">// </span><span class="s14">处理信号</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s15">NSLog</span><span class="s3">(</span><span class="s16">@"</span><span class="s17">请求热门商品</span><span class="s16">"</span><span class="s3">);</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">        </span></span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s13">// </span><span class="s14">发送数据</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span>[subscriber </span><span class="s12">sendNext</span><span class="s3">:</span><span class="s16">@"</span><span class="s17">热门商品</span><span class="s16">"</span><span class="s3">];</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">        </span></span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s9">return</span><span class="s3"> </span><span class="s9">nil</span><span class="s3">;</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">    </span>}];</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s7">// </span><span class="s3">创建热门商品的信号</span></p>
<p class="p12"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">RACSignal</span><span class="s4"> *signalB = [</span><span class="s3">RACSignal</span><span class="s4"> </span><span class="s12">createSignal</span><span class="s4">:^</span><span class="s3">RACDisposable</span><span class="s4"> *(</span><span class="s9">id</span><span class="s4">&lt;</span><span class="s3">RACSubscriber</span><span class="s4">&gt; subscriber) {</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s13">// </span><span class="s14">处理信号</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s15">NSLog</span><span class="s3">(</span><span class="s16">@"</span><span class="s17">请求最新商品</span><span class="s16">"</span><span class="s3">);</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">        </span></span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s13">// </span><span class="s14">发送数据</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span>[subscriber </span><span class="s12">sendNext</span><span class="s3">:</span><span class="s16">@"</span><span class="s17">最新商品</span><span class="s16">"</span><span class="s3">];</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">        </span></span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s9">return</span><span class="s3"> </span><span class="s9">nil</span><span class="s3">;</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">    </span>}];</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s7">// RAC:</span><span class="s3">就可以判断两个信号有没有都发出内容</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// SignalsFromArray:</span><span class="s5">监听哪些信号的发出</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// </span><span class="s5">当</span><span class="s3">signals</span><span class="s5">数组中的</span><span class="s18">所有信号都发送</span><span class="s19">sendNext</span><span class="s3"> </span><span class="s5">就会</span><span class="s18">触发</span><span class="s5">方法调用者</span><span class="s3">(self)</span><span class="s5">的</span><span class="s3">selector</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s7">// </span><span class="s3">注意</span><span class="s7">:selector</span><span class="s3">方法的参数不能乱写</span><span class="s7">,</span><span class="s3">有几个信号就对应几个参数</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// </span><span class="s5">不需要主动订阅</span><span class="s3">signalA,signalB,</span><span class="s5">方法内部会自动订阅</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">    </span>[</span><span class="s9">self</span><span class="s3"> </span><span class="s12">rac_liftSelector</span><span class="s3">:</span><span class="s9">@selector</span><span class="s3">(updateUIWithHot:new:) </span><span class="s12">withSignalsFromArray</span><span class="s3">:</span><span class="s20">@[</span><span class="s3">signalA,signalB</span><span class="s20">]</span><span class="s3">];</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p8"><span class="s3">}</span></p>
<p class="p8"><span class="s3">- (</span><span class="s9">void</span><span class="s3">)updateUIWithHot:(</span><span class="s10">NSString</span><span class="s3"> *)hot</span></p>
<p class="p8"><span class="s3">{</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p8"><span class="s3">}</span></p>
<p class="p6"><span class="s3">// </span><span class="s5">更新</span><span class="s3">UI</span></p>
<p class="p8"><span class="s3">- (</span><span class="s9">void</span><span class="s3">)updateUIWithHot:(</span><span class="s10">NSString</span><span class="s3"> *)hot new:(</span><span class="s10">NSString</span><span class="s3"> *)new</span></p>
<p class="p8"><span class="s3">{</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">    </span></span><span class="s15">NSLog</span><span class="s3">(</span><span class="s16">@"</span><span class="s17">更新</span><span class="s16">UI"</span><span class="s3">);</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p8"><span class="s3">}</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p8"><span class="s3">- (</span><span class="s9">void</span><span class="s3">)textChange</span></p>
<p class="p8"><span class="s3">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// 5.</span><span class="s18">监听文本框文字改变</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s7">// </span><span class="s3">获取文本框文字改变的信号</span></p>
<p class="p15"><span class="s4"><span class="Apple-converted-space">    </span>[</span><span class="s21">_textField</span><span class="s4">.</span><span class="s3">rac_textSignal</span><span class="s4"> </span><span class="s3">subscribeNext</span><span class="s4">:^(</span><span class="s9">id</span><span class="s4"> x) {</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s15">NSLog</span><span class="s3">(</span><span class="s16">@"%@"</span><span class="s3">,x);</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">    </span>}];</span></p>
<p class="p8"><span class="s3">}</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p8"><span class="s3">- (</span><span class="s9">void</span><span class="s3">)notification</span></p>
<p class="p8"><span class="s3">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// 4.</span><span class="s18">监听通知</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s7">// </span><span class="s3">只要发出这个通知</span><span class="s7">,</span><span class="s3">又会转换成一个信号</span></p>
<p class="p16"><span class="s4"><span class="Apple-converted-space">    </span>[[[</span><span class="s10">NSNotificationCenter</span><span class="s4"> </span><span class="s15">defaultCenter</span><span class="s4">] </span><span class="s3">rac_addObserverForName</span><span class="s4">:</span><span class="s22">UIKeyboardWillShowNotification</span><span class="s4"> </span><span class="s3">object</span><span class="s4">:</span><span class="s9">nil</span><span class="s4">] </span><span class="s3">subscribeNext</span><span class="s4">:^(</span><span class="s9">id</span><span class="s4"> x) {</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s15">NSLog</span><span class="s3">(</span><span class="s16">@"</span><span class="s17">弹出键盘</span><span class="s16">"</span><span class="s3">);</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">    </span>}];</span></p>
<p class="p8"><span class="s3">}</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p8"><span class="s3">- (</span><span class="s9">void</span><span class="s3">)event</span></p>
<p class="p8"><span class="s3">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// 3.</span><span class="s5">监听事件</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// </span><span class="s5">只要产生</span><span class="s3">UIControlEventTouchUpInside</span><span class="s5">就会转换成信号</span></p>
<p class="p15"><span class="s4"><span class="Apple-converted-space">    </span>[[</span><span class="s21">_btn</span><span class="s4"> </span><span class="s3">rac_signalForControlEvents</span><span class="s4">:</span><span class="s15">UIControlEventTouchUpInside</span><span class="s4">] </span><span class="s3">subscribeNext</span><span class="s4">:^(</span><span class="s9">id</span><span class="s4"> x) {</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">        </span></span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s15">NSLog</span><span class="s3">(</span><span class="s16">@"</span><span class="s17">点击了按钮</span><span class="s16">"</span><span class="s3">);</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">        </span></span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">    </span>}];</span></p>
<p class="p8"><span class="s3">}</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p8"><span class="s3">- (</span><span class="s9">void</span><span class="s3">)KVO</span></p>
<p class="p8"><span class="s3">{</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// 2.KVO</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s7">// </span><span class="s3">监听哪个对象的属性改变</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s7">// </span><span class="s3">方法调用者</span><span class="s7">:</span><span class="s3">就是被监听的对象</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// KeyPath:</span><span class="s5">监听的属性</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s7">// </span><span class="s3">把监听到内容转换成信号</span></p>
<p class="p15"><span class="s4"><span class="Apple-converted-space">    </span>[[</span><span class="s9">self</span><span class="s4"> </span><span class="s3">rac_valuesForKeyPath</span><span class="s4">:</span><span class="s16">@"age"</span><span class="s4"> </span><span class="s3">observer</span><span class="s4">:</span><span class="s9">nil</span><span class="s4">] </span><span class="s3">subscribeNext</span><span class="s4">:^(</span><span class="s9">id</span><span class="s4"> x) {</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">        </span></span><span class="s7">// block:</span><span class="s3">只要属性改变就会调用</span><span class="s7">,</span><span class="s3">并且把改变的值传递给你</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s15">NSLog</span><span class="s3">(</span><span class="s16">@"%@"</span><span class="s3">,x);</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">    </span>}];</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p8"><span class="s3">}</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p8"><span class="s3">- (</span><span class="s9">void</span><span class="s3">)touchesBegan:(</span><span class="s10">NSSet</span><span class="s3">&lt;</span><span class="s10">UITouch</span><span class="s3"> *&gt; *)touches withEvent:(</span><span class="s10">UIEvent</span><span class="s3"> *)event</span></p>
<p class="p8"><span class="s3">{</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">    </span></span><span class="s9">self</span><span class="s3">.</span><span class="s21">age</span><span class="s3">++;</span></p>
<p class="p8"><span class="s3">}</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p6"><span class="s3">// 1.RAC</span><span class="s5">替换代理</span></p>
<p class="p8"><span class="s3">- (</span><span class="s9">void</span><span class="s3">)delegate</span></p>
<p class="p8"><span class="s3">{</span></p>
<p class="p10"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// 1.RAC</span><span class="s5">替换代理</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s7">// RAC:</span><span class="s3">判断下一个方法有没有调用</span><span class="s7">,</span><span class="s3">如果调用了就会自动发送一个信号给你</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// </span><span class="s5">只要 </span><span class="s3">self</span><span class="s5">是</span><span class="s23">_redView</span><span class="s21"> </span><span class="s5">调用</span><span class="s3">viewDidLoad</span><span class="s5">就会转换成一个信号</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// </span><span class="s5">监听</span><span class="s3">_redView</span><span class="s5">有没有调用</span><span class="s3">btnClick:,</span><span class="s5">如果调用了就会转换成信号</span></p>
<p class="p16"><span class="s4"><span class="Apple-converted-space">    </span>[[</span><span class="s23">_redView</span><span class="s24"> </span><span class="s19">rac_signalForSelector</span><span class="s4">:</span><span class="s9">@selector</span><span class="s4">(btnClick:)] </span><span class="s3">subscribeNext</span><span class="s4">:^(</span><span class="s9">id</span><span class="s4"> x) {</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s15">NSLog</span><span class="s4">(</span><span class="s3">@"</span><span class="s5">控制器知道</span><span class="s3">,</span><span class="s5">点击了红色的</span><span class="s3">view"</span><span class="s4">);</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">    </span>}];</span></p>
<p class="p8"><span class="s3">}</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p13"><span class="s3">@end</span></p>
<p class="p9"><br></p>
<p class="p10"><span class="s3">//<span class="Apple-converted-space">  </span>RAC</span><span class="s5">常见的宏</span></p>
<p class="p6"><span class="s3">//<span class="Apple-converted-space">  </span>ViewController.m</span></p>
<p class="p6"><span class="s3">//<span class="Apple-converted-space">  </span>ReactiveCocoa</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p11"><span class="s8">#import </span><span class="s3">"ViewController.h"</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p11"><span class="s8">#import </span><span class="s3">"ReactiveCocoa.h"</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p12"><span class="s9">@interface</span><span class="s4"> </span><span class="s3">ViewController</span><span class="s4"> ()</span></p>
<p class="p13"><span class="s3">@property</span><span class="s4"> (</span><span class="s3">weak</span><span class="s4">, </span><span class="s3">nonatomic</span><span class="s4">) </span><span class="s3">IBOutlet</span><span class="s4"> </span><span class="s10">UILabel</span><span class="s4"> *label;</span></p>
<p class="p13"><span class="s3">@property</span><span class="s4"> (</span><span class="s3">weak</span><span class="s4">, </span><span class="s3">nonatomic</span><span class="s4">) </span><span class="s3">IBOutlet</span><span class="s4"> </span><span class="s10">UITextField</span><span class="s4"> *textField;</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p13"><span class="s3">@property</span><span class="s4"> (</span><span class="s3">nonatomic</span><span class="s4">, </span><span class="s3">strong</span><span class="s4">) </span><span class="s11">RACSignal</span><span class="s4"> *signal;</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p13"><span class="s3">@end</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p8"><span class="s9">@implementation</span><span class="s3"> ViewController</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p8"><span class="s3">- (</span><span class="s9">void</span><span class="s3">)viewDidLoad {</span></p>
<p class="p14"><span class="s4"><span class="Apple-converted-space">    </span>[</span><span class="s9">super</span><span class="s4"> </span><span class="s3">viewDidLoad</span><span class="s4">];</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// Do any additional setup after loading the view, typically from a nib.</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s3">//<span class="Apple-converted-space">    </span>[_textField.rac_textSignal subscribeNext:^(id x) {</span></p>
<p class="p6"><span class="s3">//<span class="Apple-converted-space">       </span></span></p>
<p class="p6"><span class="s3">//<span class="Apple-converted-space">        </span>self.label.text = x;</span></p>
<p class="p6"><span class="s3">//<span class="Apple-converted-space">    </span>}];</span></p>
<p class="p6"><span class="s3">// <span class="Apple-converted-space">   </span></span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s7">// RAC:</span><span class="s3">把一个对象的某个属性绑定一个信号</span><span class="s7">,</span><span class="s3">只要发出信号</span><span class="s7">,</span><span class="s3">就会把信号的内容给对象的属性赋值</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// </span><span class="s5">给</span><span class="s3">label</span><span class="s5">的</span><span class="s3">text</span><span class="s5">属性绑定了</span><span class="s18">文本框改变</span><span class="s5">的信号</span></p>
<p class="p17"><span class="s3"><span class="Apple-converted-space">    </span></span><span class="s25">RAC</span><span class="s3">(</span><span class="s9">self</span><span class="s3">.label,text) = </span><span class="s21">_textField</span><span class="s3">.</span><span class="s12">rac_textSignal</span><span class="s3">;</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// </span><span class="s19">KVO</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// RACObserveL:</span><span class="s5">快速的监听某个对象的某个属性改变</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s7">// </span><span class="s3">返回的是一个信号</span><span class="s7">,</span><span class="s3">对象的某个属性改变的信号</span></p>
<p class="p17"><span class="s3"><span class="Apple-converted-space">    </span>[</span><span class="s25">RACObserve</span><span class="s3">(</span><span class="s9">self</span><span class="s3">.view, center) </span><span class="s12">subscribeNext</span><span class="s3">:^(</span><span class="s9">id</span><span class="s3"> x) {</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s15">NSLog</span><span class="s3">(</span><span class="s16">@"%@"</span><span class="s3">,x);</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">    </span>}];</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// 3.</span><span class="s18">循环引用</span><span class="s5">问题</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// </span><span class="s5">把</span><span class="s3">self</span><span class="s5">转换成一个弱指针</span></p>
<p class="p17"><span class="s3"><span class="Apple-converted-space">    </span>@</span><span class="s25">weakify</span><span class="s3">(</span><span class="s9">self</span><span class="s3">);</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// </span><span class="s5">创建信号</span></p>
<p class="p12"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">RACSignal</span><span class="s4"> *signal = [</span><span class="s3">RACSignal</span><span class="s4"> </span><span class="s12">createSignal</span><span class="s4">:^</span><span class="s3">RACDisposable</span><span class="s4"> *(</span><span class="s9">id</span><span class="s4">&lt;</span><span class="s3">RACSubscriber</span><span class="s4">&gt; subscriber) {</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">     </span></span></p>
<p class="p17"><span class="s3"><span class="Apple-converted-space">        </span>@</span><span class="s25">strongify</span><span class="s3">(</span><span class="s9">self</span><span class="s3">);</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">        </span></span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s15">NSLog</span><span class="s3">(</span><span class="s16">@"%@"</span><span class="s3">,</span><span class="s9">self</span><span class="s3">.</span><span class="s22">view</span><span class="s3">);</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">        </span></span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s9">return</span><span class="s3"> </span><span class="s9">nil</span><span class="s3">;</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">    </span>}];</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">    </span></span><span class="s21">_signal</span><span class="s3"> = signal;</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">// 4.</span><span class="s5">元祖</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s7">// </span><span class="s3">快速包装一个元组</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s7">// </span><span class="s3">把包装的类型放在宏的参数里面</span><span class="s7">,</span><span class="s3">就会自动包装</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">   </span></span><span class="s11">RACTuple</span><span class="s3"> *tuple = </span><span class="s25">RACTuplePack</span><span class="s3">(</span><span class="s20">@1</span><span class="s3">,</span><span class="s20">@3</span><span class="s3">);</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p6"><span class="s3">//<span class="Apple-converted-space">    </span>NSLog(@"%@",tuple);</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">    </span></span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s7">// </span><span class="s3">快速的解析一个元组对象</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s7">// </span><span class="s3">等会的右边表示解析哪个元组</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s7">// </span><span class="s3">宏的参数</span><span class="s7">:</span><span class="s3">表示解析成什么</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">    </span></span><span class="s25">RACTupleUnpack_</span><span class="s3">(NSNumber *num1,NSNumber *num2) = tuple;</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">    </span></span><span class="s15">NSLog</span><span class="s3">(</span><span class="s16">@"%@ %@"</span><span class="s3">,num1,num2);</span></p>
<p class="p8"><span class="s3">}</span></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p5"><span class="s3"></span><br></p>
<p class="p13"><span class="s3">@end</span></p>
</body>
</html>
